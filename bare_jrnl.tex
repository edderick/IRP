\documentclass[10pt,journal,compsoc]{IEEEtran}
%\documentclass[journal]{IEEEtran}

\usepackage{paralist}
\usepackage[stable]{footmisc}
\hyphenation{op-tical net-works semi-conduc-tor}

\usepackage{hyperref}
\hypersetup{colorlinks=false, pdfborder={0 0 0}, }

%% Save the class definition of \subparagraph
\let\llncssubparagraph\subparagraph
%% Provide a definition to \subparagraph to keep titlesec happy
\let\subparagraph\paragraph
%% Load titlesec
\usepackage[compact]{titlesec}
%% Revert \subparagraph to the llncs definition
\let\subparagraph\llncssubparagraph

\titlespacing{\section}{0pt}{0.8ex}{0.2ex}
\titlespacing{\subsection}{0pt}{0.8ex}{0.15ex}
\titlespacing{\subsubsection}{0pt}{0.8ex}{0.15ex}


\begin{document}

\title{Security of the Internet of Things in the Home}
\author{Edward~Seabrook, University~of~Southampton }

\maketitle

\begin{abstract}
As the number and types of devices in the modern home grows, so does the
possibility for malicious actors to exploit them. The network technology
powering the Internet of Things must be designed with security and privacy
considerations in mind from the start. In this paper, a thorough review of the
protocol stack, security considerations and prevention mechanisms is given. 
\end{abstract}

\begin{IEEEkeywords}
Internet of Things, Security, IETF, Home Networking.
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle

\section{Introduction}
\IEEEPARstart{T}{he} ``Internet of Things'' (IoT) has become a popular
buzzword; the term is used liberally, despite lacking an agreed definition.
Kevin Ashton was the first to use the phrase in 1999, while describing the
combination of RFID tags and the Internet to monitor the supply chain at
Procter \& Gamble \cite{Ashton2009}. 

A few years later, in 2005, the ITU published a report titled ``The Internet of
Things'' \cite{ITU_IoT}, which discussed how RFID could be used to give objects
from the real world a presence on the Internet. The ideas presented in the
report added a new dimension to the Internet, envisioning a future where
Internet connectivity would be available at ``anytime'', in ``any place'', and
to ``anything''.

More recent definitions of the IoT have not limited themselves to RFID,
favouring more feature rich protocols, such as IEEE 802.14.5, Bluetooth Low
Energy (BLE) and even WiFi. The core theme that all definitions agree on, is
that as the IoT enters the mainstream, the number of Internet connected devices
will skyrocket -- Gartner predicts that by 2020, there will be over 26 billion
devices connected to the Internet \cite{Gartner2014}. 

Increasing connectivity means security is a growing concern. With more devices
and greater heterogeneity, the number of attack surfaces grows. The first
generation Internet took a lax approach to security, focusing first on
achieving functionality \cite{Bhimani1996}, this has lead to an Internet that
is insecure by default. Only recently have larger websites offered encrypted
sessions to secure communications with users -- it was not until July 2013 that
Facebook provided Transport Layer Security (TLS) as the default
\cite{Facebook2013}. 

There has been much attention placed on the IoT in business and industry.
Discussions of wireless sensor networks (WSN) to monitor manufacture and
agriculture, ensuring optimal production capacity, are common. Vehicle networks
are also of great interest: at Def Con 21, researchers demonstrated taking
control of a modern car. This proof of concept showed how attackers could put
the passengers lives at risk \cite{Illera2014}. Zanella et al. discussed the
idea of building `smart' cities \cite{Zanella2014}. There are important
security issues in these areas, especially with critical infrastructure,
however, this paper focuses only on the deployment of the IoT in a residential
setting. 

Home networks offer a unique challenge: they are rarely serviced by a competent
system administrator, and contain an range of increasingly personal devices and
appliances from a variety of inexpensive vendors \cite{Denning2013}. As such,
security requirements are high, while the difficulty of configuring the network
must be very low. 

\section{Use Cases}
To secure the IoT, it is helpful to build an understanding of the kinds of
devices that are emerging, and the ways they will be used. As `the IoT' is a
fairly vague term, there is a huge range in the products available.

\subsection{Home Automation}
Home automation involves placing sensors and actuators throughout the home.
Machine-to-machine (M2M) communication allows events detected by sensors
to trigger actuator responses, without human intervention. 

Many types of sensors can be deployed. Some check the health of the building:
these include temperature sensors, humidity sensors, and water leak detectors.
Nest has popularised Internet connected thermostats. Motion detectors can
control the home based on room occupancy; these, combined with sensors to
detect open doors and windows, allow sophisticated intrusion detection systems
to be built. Some unusual but useful sensor include the Mimobaby baby monitors,
and the NinjaBlocks doorbell.

Mechanical motors or servos can be embedded in everyday objects. These can be
fitted to radiator valves to allow granular heating control. Another example is
automatic garage door openers. Belkin WeMo, and similar products, use
electrical relays to turn devices on and off remotely. Many existing home
automation systems provide a smartphone app allowing monitoring and control of
devices from anywhere in the world. 

\subsection{Lighting}
Lighting is a very active area of the IoT, with many companies developing smart
lighting products. Older lighting control tended to replace light switches with
radio controlled module -- similar to `The Clapper' which was activated by
sound. Lifx and Philips Hue have developed smart LED light bulbs, removing the
need for switches altogether. These bulbs can also alter the colour of light
they produce.  

\subsection{The Smart Grid}
The `Smart Grid' consists of `smart meters' deployed in households. These are
network connected electricity monitors that can help homeowners understand
their energy usage. They also feedback electricity consumption data to the
supplier allowing real-time billing. The initiative aims to smooth out energy
consumption spikes at peak times, and conserve energy overall.  AlertMe is a
non-intrusive smart meter available to consumers today. 

\subsection{Body Area Networks}
Body Area Networks (BANs) contain devices kept in close proximity to a human.
They can monitor medical conditions and administer treatment, for example a
glucose monitor with an insulin pump; or they can measure fitness and track
activity, like the FitBit and Nike+ Fuelband. 

\subsection{Appliance Networks} 
Appliance networks consist of household appliances such as fridges, washing
machines, dishwashers and ovens with microprocessors and Internet connections.
LG is producing a range known as ThinQ, and Whirlpool also have a line of smart
appliances. These products all allow remote monitoring and control using a
mobile app.


\section{Network Technologies}
In the early days of the Internet, there were many competing standards: DECnet,
TCP/IP, AppleTalk, OSI, x.25 and many more \cite{Cerf1993}. Eventually TCP/IP
was accepted as the main protocol suite, and is now used almost exclusively.
Similarly, there are many competing technology stacks for the IoT. There are
advantages and disadvantages to each potential architecture, and few exist
within a vacuum -- each draws inspiration from the rest. 

As with the Internet, it is convenient to think about the IoT in terms of the
seven layer OSI model\footnote{Although TCP/IP won the battle, the numberings
from the OSI model are still widely used in industry}. The TCP/IP model is
designed with a narrow waist at the Network (IP) Layer, with many choices of
protocol sitting above and below it. This has been a key feature to the success
of TCP/IP as it provides a strong decoupling of applications from the
underlying network hardware.

\subsection{Layers 1 \& 2 -- The Physical and Link Layers}
\label{layer_1_2}
The Physical Layer (PHY) defines the medium used for the transmission of
messages. The Link Layer, also referred to as the Medium Access Control
(MAC) Layer, defines the way in which the PHY Layer is accessed. Traditional
networks made use of wired connections (such as Ethernet over Cat 5 cabling)
for this purpose. However, due to the expense and inconvenience of installing
wired networks, consumers have transitioned towards wireless technologies. 

\subsubsection{WiFi}
IEEE 802.11 is the set of specifications defining WiFi. WiFi is probably the
most familiar wireless networking protocol to home users. The latest standard
for WiFi is 802.11ac, which went to market in 2012 and boasts theoretical
maximum throughput of 6.77Gbit/s. 

WiFi is common as a wireless alternative to Ethernet, used to connect laptops,
smartphones and tablets to wireless local area networks (WLANs). WiFi is a
sensible choice for devices with mains connectivity or large batteries, where
cost is not a major factor, and where high bandwidth is required. However, high
power usage makes it unsuitable for constrained devices in the IoT.

\subsubsection{Bluetooth}
Bluetooth is a wireless communication technology used in Personal Area Networks
(PANs), intended as a wireless replacement for RS-232 serial cables. It
operates in the Industrial, Scientific and Medical (ISM) band, and is used
primarily for connecting mobile phones to headsets. Bluetooth has a lower
bandwidth and energy usage than WiFi, so is more suitable for connecting
constrained devices than WiFi. Unlike WiFi, Bluetooth also defines the higher
network layers. 

\subsubsection{Bluetooth Low Energy}
While Bluetooth was designed with power requirements in mind, it is not
suitable for ultra-low power devices. Bluetooth Low Energy (BLE), originally
named Wibree and now marketed as Bluetooth Smart, is a non-backwards
compatible protocol designed to require far less power than the Bluetooth
Classic. 

One of the main advantages of BLE is that it can share an antenna with
Bluetooth Classic, making it relatively inexpensive for hardware manufactures
to implement.  Following the Apple iPhone 4S in 2011 \cite{Engadget2011}, many
smartphones with support for BLE have been released.

\subsubsection{RFID}
Much of the early work on the IoT focused on Radio-frequency Identification
(RFID). There are two basic types of RFID "tag": active tags, which are powered
by the reader; and passive tags, which have their own power source. The main
benefit of RFID is that passive tags can be created very cheaply -- the
cheapest tags cost around \pounds0.05. More expensive active RFID tags can
have similar functionality to the other PHY layer standards. 

\subsubsection{IEEE 802.15.4}
IEEE 802.15.4 is a PHY layer technology designed specifically for the IoT. It
has very low energy usage and bandwidth. The minuscule energy requirement makes
802.15.4 ideal for Wireless Sensor Networks (WSNs) where batteries cannot be
replaced regularly. 

\subsubsection{Mobile Standards}
There are also many standards that are used in the cellular mobile telephones
-- most notably 3G and 4G/LTE. In developing countries without much previous
generation network infrastructure, we are already seeing consumers who are
jumping straight to mobile technologies without ever using cable/broadband
internet \cite{Kritzinger2013}. For many `things', mobile broadband may be an
effective way of providing connectivity.  

WiMAX is another mobile technology that could have impact in the IoT. WiMAX
falls between 3G and WiFi in terms of range and speed, but is yet to be widely
deployed.  

\subsection{Layer 3 - The Network Layer}
The network layer is the narrow waist of the TCP/IP stack, there is essentially
only one choice, IP. 

\subsubsection{IP}
The near universal use of the Internet Protocol (IP) by machines connected to
the Internet gives it a great deal of importance. IP has two major versions:
IPv4 and IPv6, although most networks today use IPv4. In 2011 the Internet
Assigned Numbers Authority (IANA) ran out of IPv4 addresses \cite{Potaroo},
meaning IPv6 should be used in the future -- this has the positive side effect
of providing a virtually unbounded address space for addressing `things'. 

\subsubsection{6LoWPAN}
IP was not designed with constrained devices in mind -- as a result, it is too
resource intensive to run on many `things'. 6LoWPAN is a protocol designed as a
minimalistic subset of IPv6 that can run over IEEE 802.15.4\footnote{Work has
also begun to port 6LoWPAN to BLE.}. It includes features such as header
compression and packet fragmentation. 6LoWPAN can be statelessly translated
into IPv6 via an inexpensive bridge or gateway. 

\subsubsection{ZigBee}
ZigBee is a wireless mesh networking protocols suite that runs above IEEE
802.15.4. It is designed to be a low cost option for connecting devices that
require low power usage, and little bandwidth. ZigBee defines the network
layer, the application layer and the high-level concept of a ZigBee device
object (ZDO). Classic ZigBee was not directly compatible with IP, making
integration with the Internet difficult. The ZigBee Alliance have since
released specifications for an IPv6 based version of ZigBee.

\subsubsection{WirelessHART}
WirelessHART is also built on top of IEEE 802.15.4, it is designed for
industrial automation. It is a more proprietary protocol, but has had a large
amount of attention in academic literature.  

\subsection{Layer 4 - The Transport Layer}
The transport layer primarily provides multiplexing for applications. There are
two major Layer 4 protocols:  UDP and TCP. User Datagram Protocol (UDP) is
connectionless, providing no guarantee of message delivery.  Transmission
Control Protocol (TCP), on the other hand, is connection-oriented, and by
retransmitting failed messaged offers a reliable service. Because of overheads
relating to retransmission and maintain connections, TCP is unsuitable for the
low power lossy networks (LLNs) of the IoT \cite{embedded}. Instead UDP is
used, with reliability handled in the higher layers.

\subsection{Layer 7 - The Application Layer}
The application layer contains a wide range of protocols, each specific a type
of program. The IoT  makes use of some existing layer 7 protocols, but others
are too heavyweight so must be redefined. 

\subsubsection{HTTP} 
Thanks to the huge popularity of the World Wide Web (W3), RESTful web services
have become very common, making HTTP a de facto standard for inter-application
communication. HTTP is a text based protocol that uses verbs such as `GET' and
`POST', to interact with a web server.  

\subsubsection{CoAP}
HTTP was not designed to be lightweight, instead it focused on human
readability. For constrained devices, HTTP is simply too bandwidth and power
intensive. The Constrained Applications Protocol (CoAP) is designed as a
compatible subset of HTTP. It is not a simple compression of HTTP, but a
completely new protocol with a stateless one-to-one mapping to (and from) HTTP. 

\subsubsection{EXI}
Efficient XML Interchange (EXI) is a binary format based on XML, that offers
lower overheads than XML when transmitting and parsing. XML is a widely used
document format; but due to its verbosity, and resultant overheads, it is not
suitable for embedded devices. 

\subsection{Other Protocols} As well as the protocols that fall neatly into the
seven layers, other protocols and services are required for the IoT to
function. These include naming and service discovery, along with middleware
that can be used to simplify the development of applications for the IoT.

\subsubsection{Service Discovery}
For objects to interact seamlessly, mechanisms are required for objects to
discover the existence of one another. For example, a network connected light
switch may need to locate all the light bulbs that it is responsible for. There
are a number of service discovery protocols for traditional IP networks,
including UPnP and mDNS (Apple Bonjour). There are implementations of mDNS
that can run on 6LoWPAN. It is also possible that we will see new service
discovery protocols used on the IoT; one example is TRENDY \cite{Butt2013}. 

\subsubsection{Routing}
Under some circumstances it is necessary to route network traffic over
constrained device networks. Traditional routing protocols such as the Routing
Information Protocol (RIP) and Open Shortest Path First (OSPF), are far too
heavyweight to run on most devices. As such, the IETF Routing Over Low-power
Lossy networks (ROLL) working group has been chartered, and have developed RPL:
IPv6 Routing Protocol for Low-Power and Lossy Networks. RPL is a distance
vector routing protocol.   

\subsubsection{Autoconfiguration}
To remove the need for home users to manually configure their networks, a number of
technologies have been developed to automatically configure the hosts.
Stateless Address Autoconfiguration (SLAAC) is part of IPv6 and is used to
generate host IP addresses based on information included in Router
Advertisements, which are flooded to the subnet by routers as part of the
Neighbour Discovery Protocol (NDP). 

\subsection{Overall Architecture}
It is very difficult right now to identify which set of protocols will dominate
the IoT. At present, the academic and standards communities are confident that
an IP based IoT will emerge. If this is the case, then the architecture
detailed in \cite{Palattella2013} is a good candidate as a standard protocol
stack. This architecture uses IEEE 802.15.4 as the PHY and MAC layers; 6LoWPAN
as the network layer; UDP for the transport layer; and CoAP as the Application
layer. This architecture is a good choice because it offers excellent
compatibility with the traditional Internet, while avoiding degradation in the
performance of the IoT with heavy, power intensive protocols. It would also be
possible to run a similar protocol stack switching 6LoWPAN for BLE. 

In contrast, many of the ``smart'' devices available to consumers right now do
not follow this architecture. At the most basic end of this scale, we see home
automation kits based on simple radios (typically 433MHz), running proprietary
protocols, connecting to base stations or mobile phones. Examples of this
include LightWaveRF and Insteon. Home automation is currently targeted mostly
at enthusiasts who are willing to build systems themselves using Raspberry Pi
and Arduino.  

Many mainstream devices use WiFi or Bluetooth Classic. LG and Whirlpool are
both manufacturing ranges of appliances with WiFi connectivity. Nest, a popular
manufacturer of smart thermostats -- now owned by Google -- support both WiFi
and 802.15.4 on their devices. The Fitbit and Nike Fuel band both connect to
smart phones over Bluetooth. These commercially available devices often lack
the always-on, global connectivity envisioned in the IoT, instead connecting
to a single device which is used as an application layer proxy.


\section{Security Goals}
As we transition from an Internet containing only virtual entities to one that
includes real world objects as well, cyber attack and data leakage become an
increasingly serious threat. There are a number of security and privacy goals that
must be met before users can be confident placing trust in the IoT.

\subsection{Confidentiality}
A confidential message is readable only by the intended recipient(s).
Mechanisms are needed to ensure that attackers can not intercept and understand
any messages that are transmitted. The level of confidentiality required varies
depending on the use case. For example, a temperature sensor in a public place
probably does not convey any information that an attacker could not collect for
themselves. On the other hand, a sensor that monitors a medical condition, has
much higher confidentiality requirements. Wireless communication is
particularly susceptible to interception, this should not be allowed to reduce
the confidentiality of the messages.  

\subsection{Integrity}
Integrity is the concept that a received message is identical to that sent.
Means of ensuring that a message does not change during transmission are
required. If alteration does occur, it should be automatically corrected, or
discarded. A message could be altered accidentally, through error in the
transmission process, or it could be tampered with maliciously by an attacker.
As the IoT will rely mainly on wireless communications, both malicious and
accidental changes are likely. 

\subsection{Availability}
Availability refers to the ability to make use of a service when it is needed.
Internet Denial of Service (DoS) attacks are fairly common place, and without
suitable provisions can render websites or networks completely unusable. The
IoT needs ways to both prevent `things' from being affected by availability
reduction attacks, and from being used as the source of DoS attacks. Although
it would be beneficial to connect many critical systems to the IoT, until
availability can be guaranteed, this should not be done.

\subsection{Authenticity}
An authentic message is one that is genuine -- the sending party can be
validated. In the IoT protocols should provide a way of preventing attackers
from pretending to be sensor nodes, and submitting bogus readings. It may be
helpful in the IoT to extend authenticity to provenance, recording a complete
history of the origin of data.  

\subsection{Authorisation}
Authorisation, also known as Access Control, ensures that the party sending a
command is allowed to make a given request. Presently, we often see WiFi
routers and other embedded devices that ship with well known default usernames
and passwords. This makes it very easy for an attacker to guess the login
credentials. Unless vendors take security more seriously, we are likely to see
the same phenomenon in the IoT. In early 2014, Proofpoint found that many low
power devices, including one smart fridge, were being used to send spam emails
\cite{Proofpoint2014}.  Theoretical, yet feasible, horror stories include the
ability for attackers to unlock doors, or gain access to personal webcams.  

\subsection{Usability \& Accessibility}
Although not strictly a security goal, usability is a key aspect of system
design. For a secure system to be successful, the target audience must not
struggle to use it -- if the end user is unable to configure a device securely,
then it effectively has no security at all.

It is important to remember that the majority of users of the IoT in the home
lack a technical understanding of the hardware and software they use; and are
often too busy to learn. As such, the workflow of enabling security should be
as simple as possible. One way of achieving this is to hide as much of the
underlying cryptographic mechanism as possible from the end user.

In the past, accessibility has often been ignored in the design of secure
systems -- WiFi passwords are typically printed in tiny writing on the
underside of the router, making the task of joining the network difficult even
for able bodied people. To be successful, especially with regards to devices
designed to help people with disabilities, accessibility must be a priority in
the design of the IoT.  


\section{Security Threats}
It is difficult to develop a strategy of prevention and mitigation without
first understanding some of the potential attacks that must be defended
against.  

\subsection{Attack Types}
Ning et al. \cite{Ning2013} divide the types of attack into the following
four broad categories:

\subsubsection{Gathering}
Gathering attacks involve collecting information by eavesdropping on
communications channels, or gaining access to storage areas. As a result of the
Snowden leaks in 2013, it was revealed that the US government has been
collecting metadata on the communications of civilians around the world. In
response the Guardian published an article detailing the extent of the
information that can be inferred from metadata alone \cite{Guardian2013}.
Gathering attacks are a breach of confidentiality. 

\subsubsection{Imitation}
Pretending to be someone (or something) you are not, in order to gain access to
a resource that you are not authorised to gain access to. A classic attack is
MAC address spoofing which can be used to perform a variety of attacks. Replay
attacks are also a form of imitation that must be defended against. This
category of attacks includes man-in-the-middle attacks, whereby an attacker
intercepts all communications between two parties. They then relay all the
communications, fooling the end points into believing they are communicating
directly. 

\subsubsection{Blocking}
Blocking refers to reducing the availability of a service. Blocking can be
achieved at almost any layer of the network. At the physical layer, radio
frequencies can be jammed; at the application layer, resources can be consumed
unnecessarily by an attacker. The most well known form of a blocking attack is
Denial of Service (DoS). 

\subsubsection{Privacy}
Privacy attacks seek to deprive victims of their privacy. One of major concerns
is of the identification of people in public places, based on the devices that
they are carrying. In 2006 security researchers at the Black Hat conference
\cite{Flexilis2006} expressed concerns that a side channel attack on the
proposed US e-passports could be used to identify travellers as American
citizens while they were travelling abroad, exposing them to unnecessary risk.

Since an increasing number of devices contain Global Positioning System (GPS)
modules, the privacy of a user's geographic location is also a strong concern.

\subsection{Attack Levels}
In \cite{Elkhodr2013} the types of attack are separated into five different
levels. These attacks refer to information security, the practice of
restricting access to data to certain groups, and are applicable mostly to
privacy issues in the IoT.

\subsubsection{First-Hand Attack}
In a first hand attack, a user inadvertently divulges some information to
another party. Either through misconfigured privacy settings, or through the
breach of a vulnerable security protocol, an attacker can gain valuable
(possibly personal) information. Although it would be easy to blame poorly
configured privacy settings\footnote{Or insecure passwords for that matter.} on
the user, a security breach that results from a difficult to use
system, could be considered to be the fault of the system designers. 

\subsubsection{Gossip Attack}
A gossip attack is one in which the attacker gains sensitive information by
compromising a node that does not directly interact with the victim. This node
may be several hops from the target, and well beyond the victim's control, yet
other nodes have relayed data regarding the target to it.  As a result,
emphasis must be placed on deciding which peers to trust, and what information
should be shared with them.

\subsubsection{Observation Attack}
An observation attack makes use of sensors placed (or compromised) by an
attacker with the intent of gaining information about their victims. An
attacker might also attempt to capture network traffic with the aim of
obtaining some information about the victim. Unlike the other attacks, an
observation attack may make use of strategically placed sensors owned by the
attacker. An example is bank card skimming machines. 

\subsubsection{Inference Attack}
Inference attacks exploit the huge body of data that will be collected in the
IoT. Data can be linked in unexpected ways, in order to obtain sensitive
information that was not revealed by a single data source alone. Understanding
privacy in anonymised datasets is an active research area. Large amounts of
work are being done on differential privacy and similar concepts. In 2007
Netflix launched a competition to improve their user ratings of films. Soon
after the competition was launched, two researchers from the University of
Texas announced they were able to identify individual users by correlating the
data with the Internet Movie Database (IMDB) \cite{Narayanan2008}.

\subsubsection{Automated Invasion Attack}
A sophisticated attacker may be able to mechanise the process of performing
attacks, making them possible on an extremely large scale. By exploiting the
pervasiveness of sensors in the IoT, an attacker may be able to infer things
that were previously unexpected. There is also the possibility of software
written to perform these attacks being sold on to less competent `hackers'. 

\subsection{Potential Attackers}
To prepare effective prevention mechanisms, potential attackers should be
identified. McAfee list these classes of attacker \cite{McAfee2011}:
white hat hackers, black hat hackers, script kiddies, hacktivists, cyber
terrorists, state sponsored hackers, and spy hackers. 

There is a great variety in the motives and abilities of these attackers. On
the lowest end of the ability scale are script kiddies, who carry out attacks
using scripts\footnote{e.g. Low Orbit Ion Cannon (LOIC), used to perform DoS
attacks.} created by more experienced hackers. To increase the impact of their
attacks, experienced hackers often instruct Script kiddies to run scripts
posted on message boards. This technique is used by the hacker group Anonymous.
Due to the low barrier of entry, script kiddies threaten home networks -- it is
relatively easy for a trusted friend or family member to carry out this kind of
attack. 

Organised crime has become increasingly involved in cyber attacks. As more
sensitive activities are carried out online, the Internet becomes a more
appealing to groups of criminals. Organised criminals are typically able to
perform more sophisticated attacks than individuals, and usually have a
financial motive. 

State sponsored hackers are teams of highly skilled, government funded
professionals. Their attacks tend to be the most sophisticated, often using
zero-day vulnerabilities but are necessarily shrouded in secrecy so it is
difficult to gauge the extent of these activities. Examples of suspected state
sponsored attacks are the Advanced Persistent Threats (APT) facing many
governments and companies; and the Stuxnet worm that targeted Iranian Nuclear
Power Facilities, stifling the country's nuclear program. Home users are not
typically a target of state sponsored attack. Although they are not hackers by
traditional definitions, the mass surveillance operations of major national
governments are a concern to home users.  

To ensure their systems and products are secure, companies often employ
whitehat hackers known as penetration testers. These security professionals
attempt to break into the systems to show where weaknesses lie. Thorough
penetration testing results in more secure products for end users.

\section{Prevention and Mitigation}
Large numbers of potential attacks, many with the ability to cause massive
amounts of damage, mean mechanisms and policies are required to reduce harm
that an attack can cause. 

\subsection{Legal Frameworks}
Legal action should not be overlooked as an effective measure against cyber
criminals. It is commonly accepted that perfect security does not exist
\cite{ThereMustBeA}. Products of any reasonable complexity are almost certain
to contain flaws. This leads to the requirement of laws to act as a safety net.
Laws aim to deter criminals from committing computer crimes, and compensate the
victims. An overview of some of the relevant law can be found in
\cite{Weber2010}. 

Regulations making vendors accountable for defects in their products may help
persuade them to ship devices in a secure state, and ensure testing is
thorough. 

\subsection{Hop-by-hop Encryption}
Hop-by-hop encryption exists between two directly connected nodes. All of the
protocols mentioned in Section \ref{layer_1_2}, offer some form of link layer
encryption. 

\subsubsection{WiFi Security}
WiFi security has a troubled past. The first WiFi security protocol, Wired
Equivalency Protocol (WEP) was completely insecure. As WEP used a stream cipher
(RC4), it was vital that keys were never reused. WEP used 24-bit initialisation
vectors (IV) to add uniqueness to the traffic keys. The Birthday Problem meant
that once ~5000 IVs\footnote{Calculated by $\sqrt[]{\frac{pi}{2} 2^{24}} $}
have been collected, the probability of a collision exceeded 50\%.  Once a
collision was found the Fluhrer, Mantin and Shamir attack could be used.  Using
{\tt aircrack-ng} any WEP key could be retrieved in a matter of seconds. Once a
WEP network was cracked, all traffic to and from the compromised access point
could be read. Fortunately, WEP is rarely used anymore.

WEP was replaced with WiFi Protected Access (WPA). There are two versions of
WPA: WPA and WPA2. WPA was designed as a stopgap measure only requiring a
firmware upgrade; whereas WPA2 is a long term solution, requiring new hardware,
and uses the Advanced Encryption Standard (AES). WPA has several modes, Pre-shared
Key (PSK) is the most common among home users. The only known WPA-PSK
vulnerabilities are dictionary attacks, and rainbow tables; as long as users
chose suitably strong passwords, along with a random SSID, this is not a
problem. 

WiFi Protected Setup (WPS), designed to increase the ease of setting up WiFi
networks, also contained a serious vulnerability. The flaw was a result of the
method by which PINs were authenticated: an eight digit PIN was used, but as it
was processed in two rounds, the keyspace was only 11,000. {\tt reaver-wps} can
be used to retrieve any WPS PIN in under 24 hours. Some modern routers have
extra precautions, such as disabling WPS after multiple failed attempts. 

\subsubsection{Bluetooth Security}
The Bluetooth specification \cite{BTSpec} defines a stream cipher called E0.
It is optimised for  hardware implementation, using multiple Linear Feedback
Shift Registers (LFSRs) and a simple state machine to generate a pseudorandom
keystream. 

In Kennedy et al. \cite{Kennedy2008}, a dizzying number of potential attacks on
Bluetooth are presented. These include: 
\begin{itemize}[$\bullet$]
\item {\bf BlueJacking:} unexpected messages are sent to the victim hoping they
will reply with login details. 
\item {\bf BlueSnarf:} exploits the Object Exchange Push service to gain
access to a mobile phone's address book. 
\item {\bf BlueBump:} exploits the fact that link keys may be used after a session
has terminated. 
\item {\bf BlueSmack:} allows an attacker to perform a simple DoS attack by
exploiting the L2CAP layer.
\item {\bf BlueDump:} can be used to cause a device to dump its link key if the
 Address of the device is known. 
\item {\bf BlueChop:} by confusing the master node of a piconet, a DoS attack can be
performed. 
\end{itemize}

\subsubsection{IEEE 802.15.4 Security}
IEEE 802.15.4 includes an extensive security specification, offering several
modes of operation: no security, encryption only, authentication only, and
encryption and authentication. 

The encryption engine used is AES, with Message Authentication Codes (MAC) used
for Authentication. The protocols are not perfect though, in 2004 Sastry et al.
\cite{Sastry2004} outlined some of the major problems that existed.  


\subsection{End-to-end Encryption}
A limitation of hop-by-hop encryption is that each node on the path between the
sender and receiver can read the message, as it is decrypted before being
forwarded. If a path contains untrusted nodes, end-to-end encryption can be
used to prevent the data being read or changed by a middle person. 

\subsubsection{DTLS}
Transport Layer Security (TLS) is a security protocol that runs over TCP. It is
widely used for securing communications between web servers and their users --
most modern browsers indicate when it is active by showing a padlock icon. As
the IoT is likely use UDP rather than TCP, regular TLS cannot be used, instead
Datagram TLS (DTLS) will need to be used. DTLS is very similar to TLS,
providing mechanisms for key negotiation, and encrypted communication using a
wide variety of encryption algorithms.  

In February 2014, researchers discovered a plaintext recovery vulnerability in
the protocol, when Cipher Block Chaining (CBC) encryption mode is used
\cite{AlFardan2012}. 

Coincidentally, serious flaws in the implementations of TLS have been in the
news recently. In February 2014 Apple published a security update to fix the
'goto fail' in their implementation of TLS.  This was caused by a repeated
statement that resulted in an incorrect verification of TLS headers. In April 2014
the OpenSSL HeartBleed bug was disclosed. The bug results from incorrect bounds
checking in the heart beat extension to TLS. This enabled a buffer overrun
attack, allowing users to retrieve large chunks of memory. After the
disclosure, CloudFlare launched a challenge for attackers to exploit an
experimental server running the vulnerable version-- within days, researchers
had retrieved private keys from the machine.

\subsubsection{IPSec}
IPSec is the security extension for IP. It offers the ability to authenticate
and encrypt IP packets. In early specifications of IPv6, IPSec was mandatory,
if security was not required, it could be effectively disabled by using the
NULL method. In RFC6463 the requirement was reduced to a recommendation. 

IPSec can be operated in a number of different modes: Authentication Header
(AH), Encapsulating Security Payload (ESP), and Security Associations (SA).  In
AH mode, an authentication header is added to to IP packets, to help maintain
the authenticity of the IP traffic. A counter helps to prevent against replay
attacks. ESP, actually encrypts the payload of the packet, providing
confidentiality. SA is used for key distribution. It has been shown that IPSec
can be modified to run within the constraints of IoT devices
\cite{Rubertis2013}.  

\subsubsection{Diet HIP}
The Host Identity Protocol (HIP) is used to decouple the identification of a
host from its location. HIP Base Exchange is used to bootstrap authenticated
communications. HIP Diet Exchange (DEX) is a cut back version of BEX for use on
constrained devices that removes many of the heavyweight cryptographic
primitives used in BEX.  Lightweight implementations of DEX have be produced
and shown to be suitable for the IoT \cite{Meca2013}. DEX can be used for
key negotiation, producing a session key that can be used with IPSec or DTLS. 

\subsection{Jamming}
Brown et al. \cite{Brown2013} present a novel mechanism for improving the
functionality and security of primitive home automation hardware. A centralised
controller is used to control the appliances. The controller has bridges
attached for each the home automation protocols used in the home. The
controller acts as a proxy for all of these devices, allowing the user to
control the devices over the Internet. 

The controller enhances security by listening for unauthorised command signals
could be interpreted by devices in the home, and emitting jamming signals to
prevent them from having an effect. This mechanism can be used to defend
against accidental attack by a neighbour, or against simplistic malicious
attacks. 

\subsection{Service Level Security}
There are many potential security issues with the protocols that are used to
reduce the administration burden of the network. 

\subsubsection{Service Discovery}
Service discovery may allow a malicious actor to advertise services on a host
that they control, tricking devices into pair with it, this is known as an mDNS
poisoning attack. IPSec or DNSSEC can be used to ensure that advertisements
only come from trusted parties \cite{Cheshire2013}. 

The other major concern with service discovery protocols, such as mDNS, is that
when attached to public networks, they can inform attackers that the device is
present on the network. An attacker may also be able to work out what the
device is and if it has any known vulnerabilities.  The NSA, and Apple both
recommend turning off mDNS when connected to a public network
\cite{NSAMacHardening} \cite{MacConfig}. The usability of this solution on
constrained devices, needs to be evaluated. 

\subsubsection{Routing}
Security considerations for routing over low-power and lossy networks are
outlined in a current Internet draft \cite{Tsao2014}. The threats mentioned
result mainly from constraints in the hardware. They include: node
impersonation, routing information exposure, routing information modification,
availability reduction attacks and node resource exhaustion. The draft also
details countermeasures, such as adding encryption to the protocol and
communicating with peers over multiple hops.

\subsubsection{Host Autoconfiguration}
SLAAC could be exploited by Router Advertisement spoofing, causing a `thing' to
connect to an unauthorised DNS server. From here, the attacker could reply to
DNS requests with the IP addresses of machines owned by the attacker, rather
that the legitimate services. The attacker could then exfiltrate data or
attempt to control the `thing'. Snooping techniques such as DHCP Guard and {\tt
ramond} can be used to prevent false router information from having an effect
on the network hosts.  

\subsection{Architectural Decisions}
There are many design decisions that still need to be made when deploying the
IoT in the home. Although other factors, such as usability must not be
overlooked, security must be among the top priorities when making these
decisions.  The design of home networks should make it as difficult as possible
for an attacker to perform a highly damaging attack. 

\subsubsection{End-to-end Addressability}
One of the biggest architectural arguments to have arisen with the introduction
of IPv6, is should we allow transparent, end-to-end addressability of devices.
With IPv4, the address space was so small that we had no choice, and were
forced to use Network Address Translation (NAT), which had the side effect of
removing end-to-end addressability. Although this breaks the end-to-end
principle, many users feel comfort in the fact that the devices inside their
network are not addressable from the outside.  

Many argue that NAT doesn't provide any security benefit over a well configured
firewall; reachability does not have to exist just because addressability does.
One counter argument to this is that given the number of bugs and
vulnerabilities that exist in the implementation of software, is it worth
exposing the network to risks of imperfection in software?

\subsubsection{Use of Application Layer Proxies}
Many of today's products do not allow for external addressing of sensors or
actuators, instead they act as application layer proxies for these devices.
This could have security benefits, as direct access to the nodes is not
available. The proxy is likely to be a far more powerful device, and has the
potential to control policy centrally. 

\subsubsection{Increased Host Security}
When the internet was first envisioned, each host was responsible for accepting
and rejecting traffic based on whether it was deemed to be genuine or not. With
the popularisation of networks in corporate setting, to increase the ease of
administration and to enforce company policy on employees, network filtering
was shifted to the network edge.

The nodes of the IoT are likely to be highly constrained in terms of processing
power. 


\section{Future Work}
Despite the large body of work that exists on the security considerations for
the IoT in domestic networks, there are still many unanswered questions. 

\subsection{Secure by Default}
One major challenge is ensuring that device vendors pick the correct security
protocols for their devices, and adhere to the specifications. It would also be
helpful to develop methods of encouraging product manufacturers to ship their
products with secure, randomly generated, usernames and passwords in order to
reduce the number of attacks that are made of devices that have never been
configured away from their defaults.

\subsection{User Education}
Research must be done on how to teach users an effective mental model for
security in their home. The negative implications of uneducated users is two
fold: firstly, they are at risk of falling victim to an attack; secondly, by
running an insecure network, they may facilitate criminals in attacking others
-- vulnerable things could become part of a botnet of things. As well as user
education, usability of device configuration must be improved. 

\subsection{Outsourcing Security}
Although the more technically inclined are likely to be strongly against it, many
users may benefit from the relocation of the security maintenance of their home
network from inside the home, to a third party, such as their ISP. 

\subsection{The Cloud of Things}
Cloud computing has been one of the largest advances in technology over the
past decade. Users are placing more and more of their data outside of their
personal machines. As the cloud merges with the IoT, more and more sensitive
data will find itself in the cloud. How can users protect themselves from their
service providers? And should the cloud provider be held responsible if data is
lost?

\subsection{Novel Network Paradigms}
There are a number of novel network paradigms that have been proposed as a
replacement of TCP/IP. One example, Information Centric Networking (ICN), aims
to replace IP with a naming system that is based on the content of the data
being requested, rather than the logical location of the data. Does this kind of
architecture need to be considered, and how can it be made secure?


\section{Conclusion}
It is clear that security is an important goal for the design of the IoT. As
technology consumes more and more of people's lives, it is essential that the
correct trade-offs are made from a security standpoint. 

So far, we have seen a large number of standards emerge, each attempting to
solve many of the problems that appear when connecting everyday objects to the
Internet. At present it is less than obvious which protocols will succeed, and
which will fade into obscurity. Many of the products currently marketed to
consumers under the umbrella of 'The Internet of Things' do not fit with the
academic models of the IoT, instead opting for moderate energy protocols that
are more familiar to consumers. 

Whether consumer electronics eventually catches up with the academic
literature, or simply continues to evolve in a different direction, the IoT
holds a huge amount of potential -- both for greatness and disaster.  


\section*{Acknowledgment}
I would like to thank Dr Tim Chown for his help, support, and guidance
throughout this project, along with all those who helped by proof reading this
report. I would also like to mention the Gigaom and FarStuff IoT podcasts as
they provided interesting background information on consumer electronics in the
IoT space. 


% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)

\bibliography{bare_jrnl}{}
\bibliographystyle{ieeetr}


\end{document}
