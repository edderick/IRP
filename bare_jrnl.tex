\documentclass[10pt,journal,compsoc]{IEEEtran}
%\documentclass[journal]{IEEEtran}

\usepackage{paralist}
\usepackage[stable]{footmisc}
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}

\title{Security of the Internet of Things in the Home}
\author{Edward~Seabrook }

\maketitle


\begin{abstract}
As the number and types of devices in the modern home grows, so does the
possibility for attack. The Internet of Things generation network technology
must be designed with security and privacy considerations in mind from the
start. In this paper, a thorough review of the protocol stack, security
consideration and prevention mechanisms is given. 
\end{abstract}

\begin{IEEEkeywords}
Internet of Things, Security, IETF.
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle

\section{Introduction}
\IEEEPARstart{T}{he} ``Internet of Things'' (IoT) has become a common buzzword
recently; the term is thrown around liberally, but there is no single accepted
definition of the concept. The earliest use of the expression was by Kevin
Ashton in 1999, to describe the use of RFID tags and the Internet in monitoring
the supply chain at Procter \& Gamble \cite{Ashton2009}. 

A few years later, in 2005, the ITU published a report titled ``The Internet of
Things'' \cite{ITU_IoT}, which discussed how RFID could be used to give objects
from the real world a presence on the Internet. The report added a new
dimension to the Internet, suggesting that in the future connectivity would be
available at ``anytime'', at ``any place'', and to ``anything''.

More recent definitions of the IoT have shied away from limiting themselves to
RFID, favouring more feature rich protocols, such as 802.14.5 and Bluetooth Low
Energy (BLE). The one core theme that all definitions agree on, is that as the
IoT enters the mainstream, the number of devices connected to the Internet will
will skyrocket -- Gartner predicts that by 2020, there will be over 26 billion
devices connected to the Internet \cite{Gartner2014}. 

In this paper, the IoT is taken to refer to the massive increase in
connectivity that we have already started to see in the past few years. This
conjunction of the traditional internet, and the emerging IoT, has been
referred to as ``the Internet of Everything'' \cite{CiscoEverything}; it is
important not to neglect the increasing presence of more traditional devices on
the Internet. 

As we enter this increasingly connected age, security becomes a serious
concern. With more devices, falling into a wider range of device classes, the
number of attack surfaces grows. The first generation Internet took a lax
approach to security, focusing first on achieving functionality. This has lead
to an Internet (specifically the World Wide Web) that is insecure by default;
only recently have larger websites begun to use encrypted sessions (through the
use of TLS) to secure communications with their users. 

There has been a large amount of attention recently placed on the IoT in a
business and industrial context. Discussions of wireless sensor networks (WSN)
used to monitor manufacturing and agriculture, ensuring optimal production
capacity, along with proposals of complex policy management frameworks, are
common place. Interesting work has also been done in the area of vehicle
networks: at Def Con 21, a horrifying demonstration showed it is possible to
take control of a modern automobile \cite{Illera2014} putting the passengers in
serious danger.  There are clearly important security issues in these areas,
especially with respect to critical infrastructure. However, this paper chooses
to focus on the deployment of the IoT in a residential setting. 

Home networks offer a unique challenge —- they lack funding for expensive
network equipment, typically acquiring devices from a variety of vendors; they
rarely have access to a competent, professional systems administrator; and they
contain an increasing range of very personal devices and appliances
\cite{ACM_ModHome}. As such, security requirements are high, while the
difficulty of configuring the network to ensure an acceptable level of security
must be very low. 


\section{Technologies}
In the early days of the Internet, there was a wide range of competing
standards: DECnet, TCP/IP, AppleTalk, OSI and many others. Eventually TCP/IP
came out on top and now is a common standard used around the world. Similarly,
there are many competing technology stacks for the IoT. There are advantages
and disadvantages to each potential architecture, but very few exists within a
vacuum -- each draws inspiration from the others. 

As with the Internet, it is convenient to think about the IoT in terms of the 7
layer OSI model\footnote{Although the TCP/IP model won the battle, the
numberings from the OSI model are still commonly used in industry}.  The TCP/IP
model is built around a narrow waist of IP (either IPv4 or IPv6), with multiple
choices of protocol sitting above and below the IP layer. This has been a key
feature to the success of TCP/IP as it allows applications to be agnostic of
the lower layers, and the lower layers, in turn, agnostics of the applications
running above them. 

\subsection{Layers 1 \& 2 -- The Physical and Link Layers}
\label{layer_1_2}
The physical layer (PHY) defines the physical medium used for the transmission
of messages. Traditional networks made use of wired connections (such as
Ethernet) for this purpose. However, due to the expense and inconvenience, we
have seen a transition away from wired networks to wireless, radio based
technologies. The link layer is used to control access to the PHY layer by
devices wishing to communicate.

\subsubsection{WiFi}
IEEE 802.11 is the set of specifications defining WiFi. WiFi is probably the
most familiar wireless networking protocol to home users. The latest standard
for WiFi is 802.11ac, although due to the long life cycle of Customer Premises
Equipment (CPE), it is yet to be widely deployed; 802.11n is probably the
most widely used revision. 

WiFi is common as a wireless alternative to Ethernet, used on laptops, mobile
phones and tablets. For devices with mains connectivity or large batteries;
where cost is not a major factor, and high bandwidth is required, WiFi may be a
sensible choice. However, the high power usage makes it unsuitable for
constrained devices in the IoT.

\subsubsection{Bluetooth}
Bluetooth is a wireless communication technology used in Personal Area Networks
(PANs), intended as a wireless replacement for RS-232 serial cables. It
operates in the Industrial, Scientific and Medical (ISM) band, and is used
primarily for connecting mobile phones to headsets. Bluetooth has a lower
bandwidth and energy usage than WiFi, so is more suitable for connecting
constrained devices than WiFi. Unlike WiFi, Bluetooth also defines the higher
levels for communication. 

\subsubsection{Bluetooth Low Energy}
While Bluetooth was designed with power requirements in mind, it is not
suitable for ultra-low power devices. Bluetooth Low Energy (BLE), originally
named Wibree and currently marketed as Bluetooth Smart, is a non-backwards
compatible protocol designed to require far less power than the Bluetooth
Classic. 

One of the main advantages of BLE is that is can share the same antenna as
Bluetooth Classic, making it cheap for hardware manufactures to implement. We
have already seen a number of smart phones, most notably the Apple iPhone 4S.

\subsubsection{RFID}
Much of the early work on the IoT focused on Radio-frequency Identification
(RFID). There are two basic types of RFID "tag": active tags, which are powered
by the reader; and passive tags, which have their own power source. The main
benefit of RFID is that the passive tags can be created very cheaply -- the
cheapest tags cost somewhere around \$0.05. More expensive active RFID tags can
have similar functionality to the other PHY layer standards. 

\subsubsection{IEEE 802.4.15}
IEEE 802.4.15 is among the most interesting PHY layer technologies for the IoT. It
has very low energy usage, but also a very low bandwidth. The very low energy
requirements makes 802.4.15 ideal for Wireless Sensor Networks (WSNs) where
batteries cannot be replaced regularly. 

\subsubsection{Mobile Standards}
There are also many standards that are used in the cellular mobile
telecommunications industry -- most notably: 3G and 4G/LTE. In developing
countries where previous generation network infrastructure has not been
deployed, we are already seeing consumers who are jumping straight to mobile
technologies without ever using cable/broadband based internet
\cite{Kritzinger2013}. For many `things', mobile broadband may be the most
effective way of providing connectivity.  

WiMAX is another mobile technology that could have impact in the internet of
things. WiMAX falls between 3G and WiFi in terms of range and speed.  

\subsection{Layer 3 - The Network Layer}
The network layer is the narrow waist of the TCP/IP stack. On the traditional
Internet IPv6 is the preferred protocol for use in to the future.

\subsubsection{IP}
The Internet Protocol (IP) has two major versions: IPv4 and IPv6. Although most
networks at present still use IPv4, we have now run out of IPv4 addresses, so
in the future we will be forced to use IPv6.

IP is an important protocol as it is used almost universally by machines
connected to the Internet. An IP network does not need to know about the higher
level protocols to carry IP traffic, an IP packet is also no concerned about
the lower levels that are carrying it. 

\subsubsection{6LoWPAN}
Unfortunately IP was not designed with constrained devices in mind, as a
result, it is too resource intensive to run on many "things". 6LoWPAN is a
protocol that is designed to work around this problem by providing a
minimalistic subset of IPv6. It includes features such as header compression
and packet fragmentation. 6LoWPAN can be statelessly translated into IPv6 via
an inexpensive bridge or gateway. 

\subsubsection{ZigBee}
ZigBee is a set of protocols that run over IEEE 802.15.4. It is designed to be a
low cost option for wireless networks that require low power usage, and have no
bandwidth requirements. ZigBee defines the network layer, the application layer
and the high level concept of a ZigBee device object (ZDO). 

\subsubsection{WirelessHART}
WirelessHART is also built on top of 802.14.5, it is designed to be used for
industrial automation. 

\subsection{Layer 4 - The Transport Layer}
The transport layer runs on top of the network layer and provides multiplexing
for applications; optionally it also provides retransmission controls in the
form of TCP. A variety of factors mean that TCP is not suitable for the
low power lossy networks (LLNs) of the IoT, instead we choose to use UDP,
handling link reliability in a higher layer.

\subsection{Layer 7 - The Application Layer}
The application layer is probably the widest layer, since any application can
define an application layer if required. There are many familiar
application layer protocols that we use on a daily basis, including SSH,
FTP, SMTP, and DNS. 

\subsubsection{HTTP} 
With the advent of the World Wide Web (W3), it has been observed that HTTP has
become the de facto standard for applications. The concept of a RESTful
webservice is widely applied.  

\subsubsection{CoAP}
HTTP was not designed to be lightweight; instead the focus on human readability
is one of the things that contributed to the massive success it has had. For
constrained devices, HTTP is simply too bandwidth, and thus power, intensive.
The Constrained Applications Protocol (CoAP) is designed as a compatible subset
of HTTP. It is not a naive compression of HTTP, but rather a completely new
protocol with a stateless one-to-one mapping to (and from) HTTP. 

\subsubsection{EXI}
Efficient XML Interchange (EXI) is a binary format based on XML, that aims to
reduce the overheads needed for transmitting and parsing XML documents. XML is
a widely used document format on the internet, but due to its human readable
verbosity, it is not ideal for embedded devices where small overheads can make
processing impossible. 

\subsection{Overall Architecture}
It is very difficult at this point in time to identify which protocol stack, if
any, will become the standard for the IoT. 

At present, the academic and standards communities are confident that we will
see an IP based IoT. If this is the case, then the architecture detailed in
\cite{Palattella2013} is a good candidate as a standard protocol stack. This
architecture uses 802.15.4 as the PHY and MAC layers; 6LoWPAN as the network
layer; UDP for the transport layer; and CoAP as the Application layer. This
architecture is a good choice because it offers excellent compatibility, and
thus connectivity, to the traditional Internet, while avoiding degradation in
the performance of the IoT with heavy, power intensive protocols. It would also
be possible to run a similar protocol stack with BLE at Layer 1.  

In contrast, many of the ``smart'' devices available to consumers right now do
not follow this architecture. At the most basic end of this scale, we see home
automation kits based on simple radios (typically 433MHz), running proprietary
protocols, connecting to base stations or mobile phones. Examples of this
include LightWaveRF and Insteon. Presently, home automation is targeted mostly
at enthusiasts who are willing to build systems themselves using Raspberry Pi
and Arduino.  

Many mainstream devices use WiFi or Bluetooth Classic. LG and Whirlpool are
both manufacturing ranges of appliances with WiFi connectivity. Nest, a popular
manufacturer of smart thermostats -- now owned by Google -- support both WiFi
and 802.15.4 on their devices. The Fitbit and Nike Fuel band both connect to
smart phones over Bluetooth. These commercially available devices often lack
the always-on,  global connectivity envisioned in the IoT, instead connecting
to a single device which is used as an application layer proxy.

\section{Security Goals}
The internet is, for many, no longer a luxury, but a lifeline. Many of our
everyday tasks have been greatly simplified by the internet. The IoT will only
exaggerate this effect, increasing our reliance on technology. The devices that
make up the IoT that reside in our homes are likely to collect huge amounts of
sensitive information -- it is paramount that we avoid anything happening to
this data, as the consequences could be significant. 

As we transition from an Internet containing only virtual entities to an
Internet consisting of real world objects as well, the damages that will be
possible through attack or data leak will increase. There are a number of
security and privacy goals that must be met for users to be able to place trust
in the IoT.

\subsection{Confidentiality}
A confidential message should only be readable by its intended recipients.
Mechanisms are needed to ensure that attackers are not able to intercept and
understand any messages that are transmitted. The level of confidentiality
required varies depending on the use case: for example, a temperature sensor in
a public place probably does not convey any information that an attacker could
not collect for themselves; whereas a medical sensor for a potentially
embarrassing medical condition will have much higher confidentiality
requirements. Wireless communication is particularly susceptible to
interception, this should not reduce the confidentiality of the messages.  

\subsection{Integrity}
Integrity is the concept that a message should be exactly the same when it is
received as it was when it was sent. Mechanisms are required to ensure that a
message does not change during transmission, if the message does change in
transit, it should be either automatically corrected, or discarded. A message
could be altered accidentally, through some error in the transmission process,
or it could be altered maliciously by an attacker. As the IoT will rely mainly
on wireless communications, both malicious and accidental changes are likely. 

\subsection{Availability}
Availability refers to the ability to make use of a service when it is needed.
On the regular Internet we are familiar with Denial of Service (DoS) attacks,
which render websites or networks completely unusable. The IoT needs mechanisms
that both prevent it from being the target of an availability reduction attack
and from being used as the source of DoS attacks.

\subsection{Non-repudiation}
Non-repudiation mechanisms ensure that if an action was performed by somebody,
then it is impossible for them to claim that they had not performed the action.
This security goal seems to be less relevant to the IoT than the others. 

\subsection{Authenticity}
Authenticity is assuring that a message has been sent by the party from which
it claims to have been sent. In the IoT protocols should provide a way of
preventing attackers, for example, from pretending to be sensor nodes, and
submitting bogus readings, that could lead to undesired actions. It may be
helpful in the IoT to extend authenticity to provenance, recording a complete
history behind the origin of data.  

\subsection{Authorization}
Authorization ensures that the party sending a command is actually allowed
to make the request that they have made. Presently, we often see WiFi routers
and other embedded devices that ship with well known default usernames
and password. This makes it very easy for an attacker to guess the login
credentials. If things do not change, then we are likely to see the same
phenomenon in the IoT. In early 2014, Proofpoint found that many low power
devices, including one smart refrigerator, were being used to send spam emails
\cite{Proofpoint2014}.


\section{Security Threats \footnote{I may merge this section back into the one above} }
It is difficult to develop a strategy of prevention and mitigation without
first understanding some of the potential attacks that should be defended
against.  

\subsection{Attack Types}
H. Ning et al \cite{Ning2013} divide the types of attack into the following
four broad categories:

\subsubsection{Gathering}
Gathering attacks involve collecting information by eavesdropping on
communications channels, or gaining access to storage areas. As a result of the
Snowden leaks in 2013, it was revealed that the US government has been
collecting metadata on the communications of civilians around the world -- as
response the Guardian published an article detailing how much can be inferred
from metadata alone \cite{Guardian2013}. 

Gathering attacks are a breach of confidentiality. 

\subsubsection{Imitation}
Pretending to be someone (or something) you are not, in order to gain access to
a resource that you are not authorised to gain access to. A classic attack is
MAC address spoofing which can be used to perform a variety of attacks. Replay
attacks are also a form of imitation that must be defended against. 

\subsubsection{Blocking}
Blocking refers to reducing the availability of a service. Blocking can be
achieved at almost any layer of the network. At the physical layer, radio
frequencies can be jammed; at the application layer, resources can be consumed
unnecessarily by an attacker.  

\subsubsection{Privacy}
Privacy attacks seek to deprive victims of their privacy. One of major concerns
is of the identification of people in public places, based on the devices that
they are carrying. In 2006 security researchers at the Black Hat conference
\cite{Flexilis2006} expressed concerns that a side channel attack on the
proposed US e-passports could be used to identify travellers as American
citizens while they were travelling abroad, exposing them to unnecessary risk.

The privacy of a users geographic location, is also a strong concern as an
increasing number of devices contain GPS modules. 

\subsection{Attack Levels}
In \cite{Elkhodr2013} the types of attack are separated into five different
levels of attack. These attacks refer mostly to Privacy issues in the IoT.

\subsubsection{First-Hand Attack}
In a first hand attack, a user inadvertently divulges some information that
they did not intend to. Either through misconfigured privacy settings, or
through the breach of a vulnerable security protocol, an attacker can gain
valuable information about a human being, that would otherwise have been
secret.  

\subsubsection{Gossip Attack}
A gossip attack is one where the attacker gains some information by
compromising a node that does not directly interact with the victim. 

\subsubsection{Observation Attack}
An observation attack makes use of sensors placed (or compromised) by an attack
with the intent of gaining information about their victims.

\subsubsection{Inference Attack}
Inference attacks exploit the huge body of data that will be collected in the
IoT, linking the data in unexpected ways to obtain (or gain a strong suspicion
of) sensitive information that was not revealed by the possession of a single
data source. 

\subsubsection{Automated Invasion Attack}
A sophisticated attacker may be able to mechanise the process of performing
attacks, making them possible on an extreme scale. 

\section{Prevention and Mitigation}
With such a large number of potential attacks, all with the ability to do huge
amounts of damage, we need mechanisms and policies in place to reduce the
amount of damage that can be done by an attacker. 

\subsection{Legal Frameworks}
Legal frameworks should not be overlooked as an effective measure against cyber
criminals. It is commonly accepted that perfect security does not exists
\cite{ThereMustBeA}, implementers of secure products of any reasonable
complexity, are almost certain to make some mistakes. This lack of undeniable
security leads us to require laws to act as a safety net, deterring criminals
from committing computer crimes, and compensating victims attacks. An overview
of some of the relevant law can be found in \cite{Weber2010}. 

It may also be helpful to put in place regulations to force hardware and
software vendors to ship products in a secure default state, and to place
strong recommendations on the minimum levels of testing required. 

\subsection{Hop-by-hop Encryption}
Hop-by-hop encryption is the encipherment of messages between two nodes on the
communication path. All of the  protocols mentioned in Section \ref{layer_1_2}, offer
some level of encryption on their link. 

\subsubsection{WiFi Security}
In terms of security, WiFi has has a shaky past. The first security protocol
for WiFi, Wired Equivalency Protocol (WEP) had serious issues leaving it
completely insecure. Using the software package {\tt aircrack-ng} an
unskilled attacker can crack WEP keys in a matter of seconds. Another
extension, WiFi Protected Setup (WPS) also contained a serious
vulnerability, {\tt reaver-wps} is a tool that can be used to retrieve any
WPS PIN in under 24 hours. As far as we know, the current security standard
for WiFi, WiFi Protected Access II (WPA2) is secure, when used with a
suitably long preshared key (PSK). 

\subsubsection{Bluetooth Security}
The security used in Bluetooth is known as the E0 encyrption engine, which uses
Linear Feedback Shift Registers (LFSRs) to generate a pseudorandom keystream,
so may well have serious security weaknesses.


In A Review of Internet Security, a wide range of potential attack on Bluetooth
are presented. These include Bluejacking, a simple attack in which a user sends
bogus data to... 


\subsection{End-to-end Encryption}
The inherent problem with hop-by-hop encryption is that each node on the path
between the sender and receiver.   

\subsubsection{DTLS}
When browsing the Web today, most users are familiar with the padlock symbol in
the corner of the browser, although few know what it actually means. It
indicates that communications to the web server are being secured with
Transport Layer Security (TLS). As it is likely that the IoT will use UDP
rather than TCP, TLS cannot be used, instead Datagram TLS (DTLS) will need to
be used. DTLS is very similar to TLS, allowing communications to be encrypted
using a wide variety of encryption algorithms.  

In February 2014, researchers at RHUL discovered a vulnerability in the
protocol, when Cipher Block Chaining (CBC) is used as the mode for the
encryption. 


\subsubsection{IPSec}
IPSec is the security extensions for IP. It offers the ability to authenticate
and encrypt IP packets. In early specifications for IPv6, IPSec was mandatory,
if one did not require security they could set the methods to NULL -- RFC6463
reduced the requirement to a recommendation. There has been a small amount
of work evaluating the feasibility of IPSec on constrained devices, that
has shown that it would be possible. 

\subsubsection{Diet HIP}
The Host Identity Protocol (HIP) can be used to decouple the secure
identification of a host from its location, and allow authenticated
communications. Diet HIP is a cut back version of HIP that can be used on
constrained devices. 

\subsection{Architectural Decisions}
Need to make sure that the architecture we settle on makes it difficult to do an attack. 

Do we allow end-to-end addressability?

\section{Future Work}
What things are still open research problems. 

\begin{itemize}
\item How do we force vendors to ship devices with secure password?
\item How do we educate users?
\item Will we be able to outsource security?
\end{itemize}


\section{Conclusion}
A summary and evaluation of the findings presented in the paper.



\section*{Acknowledgment}
The author would like to thank 


% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)
\begin{thebibliography}{1}

\bibitem{Ashton2009}
Ashton, K. (2009). That `Internet of Things' Thing. http://www.rfidjournal.com/articles/view?4986

\bibitem{ITU_IoT}
ITU. (2005). ITU Internet Reports: The Internet of Things

\bibitem{Gartner2014}
Gartner. (2014). Gartner Says the Internet of Things Will Transform the Data Center. http://www.gartner.com/newsroom/id/2684915

\bibitem{CiscoEverything}
http://www.cisco.com/web/about/ac79/innov/IoE.html

\bibitem{Illera2014}
Illera, A. G., Vidal, J. V. (2013) Def Con 21: Dude WTF in My Car?  

\bibitem{ACM_ModHome}
Denning, T., Kohno, T., \& Levy, H. M. (2013). Computer Security and the Modern Home. Communications of the ACM, 56(1), 94. 

\bibitem{Guardian2013}
Guardian. (2013). A Guardian guide to your metadata. http://www.theguardian.com/technology/interactive/2013/jun/12/what-is-metadata-nsa-surveillance

\bibitem{Palattella2013}
Palattella, M. R., Accettura, N., Vilajosana, X., Watteyne, T., Grieco, L. A., Boggia, G., \& Dohler, M. (2013). Standardized Protocol Stack for the Internet of (Important) Things. IEEE Communications Surveys \& Tutorials, 15(3), 1389–1406.ng2013 

\bibitem{Ning2013}
Ning, H., Liu, H., \& Yang, L. T. (2013). Cyberentity Security in the Internet of Things. Computer, 46(4), 46–53. 

\bibitem{Flexilis2006}
Flexilis Inc. (2006). United States e-Passport Shield Failure Vulnerability. Black Hat Conference

\bibitem{Elkhodr2013}
Elkhodr, M., Shahrestani, S., \& Cheung, H. (2013). The Internet of Things: Vision \& challenges. In IEEE 2013 Tencon - Spring (pp. 218–222). IEEE. doi:10.1109/TENCONSpring.2013.6584443

\bibitem{Proofpoint2014}
Proofpoint. (2014). Proofpoint Uncovers Internet of Things (IoT) Cyberattack. http://www.proofpoint.com/about-us/press-releases/01162014.php

\bibitem{ThereMustBeA}
Bruce Schneier; TODO: Find where he said it.

\bibitem{Weber2010}
Weber, R. H. (2010). Internet of Things – New security and privacy challenges. Computer Law \& Security Review, 26(1), 23–30. 

\bibitem{Kritzinger2013}
Kritzinger, E., \& Solms, S. (Basie) von. (2013). Home User Security- from Thick Security-oriented Home Users to Thin Security- oriented Home Users. In Science and Information Conference (SAI), 2013 (pp. 340–345). London.

\end{thebibliography}


%\vfill

% that's all folks
\end{document}
