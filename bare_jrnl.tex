\documentclass[10pt,journal,compsoc]{IEEEtran}
%\documentclass[journal]{IEEEtran}

\usepackage{paralist}
\usepackage[stable]{footmisc}
\hyphenation{op-tical net-works semi-conduc-tor}

\usepackage{hyperref}
\hypersetup{colorlinks=false, pdfborder={0 0 0}, }

%% Save the class definition of \subparagraph
\let\llncssubparagraph\subparagraph
%% Provide a definition to \subparagraph to keep titlesec happy
\let\subparagraph\paragraph
%% Load titlesec
\usepackage[compact]{titlesec}
%% Revert \subparagraph to the llncs definition
\let\subparagraph\llncssubparagraph

\titlespacing{\section}{0pt}{0.8ex}{0.2ex}
\titlespacing{\subsection}{0pt}{0.8ex}{0.15ex}
\titlespacing{\subsubsection}{0pt}{0.8ex}{0.15ex}

\linespread{1}

\begin{document}

\title{Security of the Internet of Things in the Home}
\author{Edward~Seabrook, University~of~Southampton \\ ejfs1g10@ecs.soton.ac.uk}

\maketitle

\begin{abstract}
As the number and types of devices in the modern home grows, so does the
possibility for malicious actors to exploit them. The network technology
powering the Internet of Things must be designed with security and privacy
considerations in mind from the start. In this paper a thorough review of the
protocol stack, security considerations and prevention mechanisms is given. 
\end{abstract}

\IEEEpeerreviewmaketitle

\section{Introduction}
\IEEEPARstart{T}{he} ``Internet of Things'' (IoT) has become a popular
buzzword, and despite lacking an agreed definition, is used liberally. Kevin
Ashton coined the phrase in 1999, when describing the combination of Radio
Frequency ID (RFID) tags and the Internet for supply chain monitoring at
Procter \& Gamble \cite{Ashton2009}. 

In 2005, the ITU published a report titled ``The Internet of Things''
\cite{ITU_IoT}, discussing how RFID could give physical objects an online
presence. The ideas presented added a new dimension to the Internet,
envisioning a future where Internet connectivity would be available at
``anytime'', in ``any place'', and to ``anything''.

Recent IoT definitions have not been limited to RFID but include protocols such
as IEEE 802.14.5 and Bluetooth Low Energy (BLE). They all agree that the IoT
will result in astronomical increases in the number of devices online --
Gartner predicts that by 2020, over 26 billion devices will be connected to the
Internet \cite{Gartner2014}. 

Increasing connectivity means security is a growing concern. More devices and
greater heterogeneity, introduces new attack surfaces. The Internet had a lax
approach to security, focusing first on achieving functionality
\cite{Bhimani1996}. As such the Internet is not secure by default.
Until recently few websites offered secure sessions -- it was not until July
2013 that Facebook provided Transport Layer Security (TLS) as the default
\cite{Facebook2013}. 

Much research has focused on the IoT in business and industry, including
discussions of wireless sensor networks (WSNs) to monitor manufacture and
agriculture. Vehicle networks are also interesting: at Def Con 21, researchers
demonstrated taking control of a modern car, showing how attackers could put
passengers lives at risk \cite{Illera2014}. Zanella et al. discussed the idea
of building `smart' cities \cite{Zanella2014}. There are important security
issues in these areas, especially with respect to critical infrastructure,
however, this is beyond the scope of this project.  

Home networks offer a unique challenge: they are rarely serviced by a competent
system administrator, and contain an range of increasingly personal devices and
appliances from a variety of inexpensive vendors \cite{Denning2013}. As such,
security requirements are high, while the difficulty of configuring the network
must be very low. 

\section{Use Cases}
To secure the IoT, it is helpful to build an understanding of the types of
emerging devices, and their uses. The `IoT' is a vague term, so there
is a huge range in the types of products available.

\subsection{Home Automation}
Home automation involves placing sensors and actuators throughout the home.
Machine-to-machine (M2M) communication allows sensor detected events to trigger
actuator responses, without human intervention. 

Many types of sensors exist. To check the health of the building there are
temperature and humidity sensors, and water leak detectors. Nest has
popularised Internet connected thermostats. Motion detectors can control the
home based on room occupancy; and combined with sensors to detect open doors
and windows, sophisticated intrusion detection systems can be built. Unusual,
but useful, sensors include Mimobaby baby monitors, and the NinjaBlocks
doorbell.

Mechanical motors and servos can be embedded in everyday objects. When fitted
to radiator valves they allow granular heating control. Belkin WeMo, and
similar products, use electrical relays to turn devices on and off remotely.
Many existing home automation systems provide a smartphone app to monitor and
control devices from anywhere in the world. 

\subsection{Lighting}
Smart lighting is an active area of the IoT, with many companies involved.
Older lighting control replaced light switches with radio controlled module.
Lifx and Philips Hue have developed smart LED light bulbs, removing the need
for switches altogether. These bulbs can also produce many colours of light. 

\subsection{The Smart Grid}
The `Smart Grid' contains many `Smart Meters': network connected electricity
monitors deployed in consumers houses. They aim to help consumers understand
and reduce their energy usage.  Some can feedback electricity consumption data
to the supplier for real-time billing.  AlertMe is a non-intrusive smart meter
available to consumers today. 

\subsection{Body Area Networks}
Body Area Networks (BANs) consist of devices kept in close proximity to a
human. They can monitor medical conditions and administer treatment, for
example a glucose monitor with an insulin pump; or they can measure track
activity to measure fitness, like the FitBit and Nike+ Fuelband. 

\subsection{Appliance Networks} 
Appliance networks consist of Internet connected household appliances such as
fridges, washing machines, dishwashers and ovens.  LG make a range known as
ThinQ, and Whirlpool also have a line of smart appliances called `6th Sense
Live'. These products all allow remote monitoring and control using a mobile
app.


\section{Network Technologies}
The early Internet, offered many competing standards: DECnet, TCP/IP,
AppleTalk, OSI, x.25, and many more \cite{Cerf1993}. Eventually TCP/IP was
accepted as the main protocol suite and is now used almost exclusively.
Similarly, there are many competing technologies for the IoT. Each has
advantages and disadvantages, but few exist within a vacuum -- each draws
inspiration from the rest. 

As with the Internet, the IoT can be split into seven layer OSI
model\footnote{Although TCP/IP won the battle, the numberings from the OSI
model are still widely used in industry}. The TCP/IP model is designed with a
narrow waist at the Network (IP) Layer, with many choices of protocol sitting
above and below it. This has been key to the success of TCP/IP as it
provides strong decoupling of applications from the network hardware.

\subsection{Layers 1 \& 2 -- The Physical and Link Layers}
\label{layer_1_2}
The Physical Layer (PHY) defines the hardware used for the transmission of
messages. The Link Layer, also referred to as the Medium Access Control (MAC)
Layer, defines how the PHY Layer is accessed. Traditional networks made use of
wired connections (such as Ethernet over Cat 5 cabling) for this purpose.
However, due to the expense and inconvenience of installing wired networks,
consumers have transitioned towards wireless technologies. 

\subsubsection{WiFi}
IEEE 802.11 is the set of specifications defining WiFi. WiFi is probably the
most familiar wireless networking protocol to home users. The latest standard
for WiFi is 802.11ac, which went to market in 2012 and boasts theoretical
maximum throughput of 6.77Gbit/s. 

WiFi is common as a wireless alternative to Ethernet, used to connect devices
to wireless local area networks (WLANs). WiFi is a sensible choice when mains
electricity or large batteries are available, where cost is not a major
factor, and where high bandwidth is required. However, high power usage makes
it unsuitable for constrained devices.

\subsubsection{Bluetooth \& Bluetooth Low Energy}
Bluetooth is used in in Wireless Personal Area Networks (WPANs). It is a
wireless replacement for RS-232 serial cables. It is commonly used for
connecting mobile phones to headsets. Bluetooth has a lower bandwidth and
energy usage than WiFi, so is more suitable for connecting devices constrained
in terms of battery life and processing power. Unlike WiFi, Bluetooth also
defines the higher network layers. 

Bluetooth Classic is not suitable for ultra-low power devices. Bluetooth Low
Energy (BLE), originally named Wibree and now marketed as Bluetooth Smart, is a
non-backwards compatible protocol designed to require far less power than
Bluetooth Classic. BLE can share an antenna with Bluetooth Classic, so is
relatively cheap for hardware manufactures to implement. Following the Apple
iPhone 4S in 2011 \cite{Engadget2011}, many smartphones with support for BLE
have been released.

\subsubsection{RFID -- Radio Frequency Identification}
The early IoT focused on RFID. There are two basic types of RFID "tag": passive
tags, powered by the reader; and active tags, with their own power source.
Passive RFID tags can be created very cheaply -- costing as little as
$\sim$\pounds0.05. Expensive active RFID tags can have similar functionality
to the other PHY layer standards. 

\subsubsection{IEEE 802.15.4}
IEEE 802.15.4 is a PHY layer technology designed for the IoT. It has very low
energy usage and bandwidth. This makes 802.15.4 ideal for Wireless Sensor
Networks (WSNs) where batteries cannot be replaced regularly. 

\subsubsection{Mobile Standards}
3G and 4G Long Term Evolution (LTE) are the standards used in most smartphones.
In developing countries without much traditional network infrastructure, we are
already seeing consumers jump straight to mobile broadband without ever using
cable/broadband Internet \cite{Kritzinger2013}. For many `things', mobile
broadband may be an effective way of providing connectivity.  

\subsection{Layer 3 - The Network Layer}
The network layer is the narrow waist of the TCP/IP stack. It handles
addressing and forwarding of Internet traffic. 

\subsubsection{IP -- The Internet Protocol}
IP is used by all machines connected to the Internet. It has two major
versions: IPv4 and IPv6. Most networks today use IPv4. In 2011 the Internet
Assigned Numbers Authority (IANA) ran out of IPv4 addresses \cite{Potaroo}
resulting in a slow transition to IPv6, which has a far bigger address space.

\subsubsection{6LoWPAN -- IPv6 over Low Power WPANs}
IP was not designed for constrained devices -- it is too resource intensive to
run on many `things'. 6LoWPAN is a minimalistic subset of IPv6 that can run
over IEEE 802.15.4\footnote{Work has also begun to port 6LoWPAN to BLE.}. It
offers header compression and packet fragmentation.  6LoWPAN can be statelessly
translated into IPv6 via an inexpensive bridge or gateway. 

\subsubsection{ZigBee}
ZigBee is a wireless mesh networking protocols suite that runs over IEEE
802.15.4. It is designed as a low cost way of connecting devices that require
low power usage, and need little bandwidth. ZigBee defines the network and
application layers, along with software abstractions. Classic ZigBee was not
compatible with IP, so integration with the Internet was difficult. An IPv6
based version of ZigBee now exists to compete with 6LoWPAN.

\subsection{Layer 4 - The Transport Layer}
The Transport Layer primarily provides multiplexing for applications. There are
two major protocols:  UDP and TCP. The User Datagram Protocol (UDP) is
connectionless, providing no guarantee of message delivery. The Transmission
Control Protocol (TCP), on the other hand, is connection-oriented. By
retransmitting failed messages it offers a reliable service. Overheads relating
to retransmission and maintaining connections make TCP unsuitable for the low
power lossy networks (LLNs) of the IoT \cite{embedded}. Instead UDP is used --
reliability is handled in a higher layer.

\subsection{Layer 7 - The Application Layer}
Layers 5 and 6 are the session and presentation layers, but are rarely used.
The application layer contains a wide range of protocols. The IoT  makes use of
some existing layer 7 protocols, but others are too heavyweight so must be
redefined. 

\subsubsection{HTTP} Due to the popularity of the World Wide Web (W3), RESTful
web services have become very common. HTTP is a de facto standard for
application communication. HTTP is a text based protocol that uses verbs such
as `GET' and `POST' to interact with a web server.  

\subsubsection{CoAP}
HTTP was not designed to be lightweight, instead it focuses on human
readability. For constrained devices, HTTP is too bandwidth and power
intensive. The Constrained Applications Protocol (CoAP) is a compatible subset
of HTTP. It is not a simple compression of HTTP, but a completely new protocol
with a stateless one-to-one mapping to (and from) HTTP. 

\subsubsection{EXI}
Efficient XML Interchange (EXI) is a binary format based on XML, with lower
overheads than XML when transmitting and parsing. XML is a widely used document
format; but due to its verbosity, it can be unsuitable for embedded devices. 

\subsection{Other Protocols} 
Beyond the 7 layer model, there are protocols and services required for the IoT
to function. These include naming, service discovery, and middleware designed
to simplify the development of applications for the IoT.

\subsubsection{Service Discovery}
For objects to interact seamlessly, they require mechanisms for discovering one
another. For example, a network connected light switch needs to locate light
bulbs it is responsible for. There are several existing service discovery
protocols, including Universal Plug and Play (UPnP) and multicast
DNS\footnote{Also known as Apple Bonjour.} (mDNS). There are implementations of
mDNS that can run on 6LoWPAN. It is also possible that we will see new service
discovery protocols used on the IoT; one example is TRENDY a RESTful service
discovery protocol \cite{Butt2013}. 

\subsubsection{Routing}
Sometimes it is necessary to route IP traffic over constrained device networks.
Traditional routing protocols such as Open Shortest Path First (OSPF), are far
too heavyweight to run on constrained devices. As such, the IETF Routing Over
Low-power Lossy networks (ROLL) working group has been chartered, and have
developed RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks. RPL is a
distance vector routing protocol.

\subsubsection{Autoconfiguration}
To remove the need for manual configuration, a number of technologies have been
developed to automatically configure hosts. Stateless Address Autoconfiguration
(SLAAC) is part of IPv6 and is used to generate host IP addresses based on
information included in Router Advertisements (RAs). These are flooded to the
subnet by routers as part of the Neighbour Discovery Protocol (NDP). This
essentially replaces the centralised Dynamic Host Configuration Protocol (DHCP)
used commonly with IPv4. 

\subsection{Overall Architecture}
It is hard to identify which set of protocols will dominate the IoT. At
present, the academic and standards communities are confident that an IP based
IoT will emerge. The architecture detailed in \cite{Palattella2013} is a good
example of this: using IEEE 802.15.4 as the PHY and MAC layers; 6LoWPAN as the
network layer; UDP for the transport layer; and CoAP as the Application layer.
These protocols offer excellent compatibility with the traditional Internet,
while still allowing good performance in the IoT. It would be possible to
switch 6LoWPAN for BLE. 

In contrast, many of the ``smart'' devices currently available to consumers do
not follow this architecture. At the most basic end of the scale, we see home
automation kits based on simple radios (typically 433MHz), running proprietary
protocols, connecting to base stations or mobile phones. Examples of this
include LightWaveRF and Insteon. Home automation is currently targeted mostly
at enthusiasts who are willing to build systems themselves using Raspberry Pis
and Arduinos.

Many `things' already on the market use WiFi or Bluetooth Classic. LG and
Whirlpool appliances use WiFi.  Nest thermostats support both WiFi and
802.15.4. The Fitbit and Nike+ Fuel band both connect to smart phones over
Bluetooth. These commercially available devices often lack the always-on,
global connectivity envisioned in the IoT.


\section{Security Goals}
As we transition from an Internet containing only virtual entities to one that
includes real world objects as well, cyber attack and data leakage become an
increasingly serious threat. There are a number of security and privacy goals
that must be met before users can be place trust in the IoT.

\subsection{Confidentiality}
A confidential message is readable only by the intended recipient(s).
Attackers must not be able to intercept and interpret messages. The level of
confidentiality required depends on the use case. For example, a temperature
sensor in a public place transmits no information an attacker could not collect
themself. Conversely, a sensor to monitor a medical condition requires much
more confidentiality. 

\subsection{Integrity}
Integrity is the concept that a message is received identical to when sent.
Means of ensuring that a message does not change during transmission are
required. If changes, the message should be automatically corrected, or
discarded. A message could be altered through error in the transmission
process, or it could be tampered with maliciously by an attacker. 

\subsection{Availability}
Availability refers to the ability to use a service when needed.  Denial of
Service (DoS) attacks are common place, and without suitable provisions can
render websites and networks completely unusable. The IoT needs ways to both
prevent `things' from being affected by DoS attacks, and from being used to
originate them.

\subsection{Authenticity}
An authentic message is one where the sending party can be validated. In the
IoT there should be ways to prevent attackers from pretending to be sensor
nodes and submitting bogus readings. It may be helpful in the IoT to extend
authenticity to provenance, recording the history of the data.

\subsection{Authorisation}
Authorisation (or Access Control) ensures the requesting party is allowed to
perform a requested action. Many devices, notably Wifi routers, use well known
default usernames and passwords. This makes it trivial for an attacker to guess
login credentials. Unless vendors take security more seriously, the same thing
will happen in the IoT. In early 2014, Proofpoint found many embedded devices,
including one smart fridge, were being used to send spam emails
\cite{Proofpoint2014}. 

\subsection{Usability \& Accessibility}
Usability is a key aspect of system design. For a secure system to be
successful, the target audience must not struggle to use it -- if the user
cannot configure a device securely, then it effectively has no security at all.
The majority of users of the IoT in the home lack technical understanding. As
such, the workflow to enable security should be as simple as possible. This can
be achieved by hiding the underlying cryptographic mechanisms. 

Accessibility has often been ignored in secure systems design -- WiFi passwords
are usually printed in tiny writing on the underside of the router. This makes
joining a network difficult even for able bodied people. To be successful
accessibility must be a priority in the design of the IoT.


\section{Security Threats}
To develop a strategy of prevention and mitigation, understanding of the
potential attacks is required.  

\subsection{Attack Types}
Ning et al. \cite{Ning2013} divide the types of attack into the following
four broad categories:

\subsubsection{Gathering}
Gathering attacks collect information by eavesdropping on communication, or
gaining access to storage. As a result of the Snowden leaks in 2013, it was
revealed that the US government has been collecting metadata on the civilian
communications around the world. In response the Guardian published an article
detailing the extent of the information that can be inferred from metadata
alone \cite{Guardian2013}. Gathering attacks are a breach of privacy, and
possibly confidentiality. 

\subsubsection{Imitation}
Pretending to be someone (or something) you are not, in order to gain access to
a resource that you are not authorised to access. MAC address spoofing can used
to perform a variety of attacks. Replay attacks are also a form of imitation
that must be defended against. Man-in-the-middle attacks are an imitation
attack whereby an attacker intercepts all communications between two parties.
They then relay all communications, fooling the end points into believing they
are communicating directly. 

\subsubsection{Blocking}
Blocking refers to reducing the availability of a service. Blocking can be
achieved at almost any layer of the network. At the physical layer, radio
frequencies can be jammed; at the application layer, server state can be
consumed by an attacker, resulting in a DoS attack. Malware can be used to
prevent access to a device.

\subsubsection{Privacy}
Privacy attacks seek to deprive victims of their privacy. A major concerns is
the identification of people in public places based on the devices they are
carrying. At the Black Hat USA conference in 2006 \cite{Flexilis2006}
researchers expressed concerns that side channel attacks on the proposed US
e-passports could identify travellers as American citizens while abroad,
exposing them to unnecessary risk.

As more devices contain Global Positioning System (GPS) modules, the privacy of
a user's geographic location is also a strong concern.

\subsection{Attack Levels}
In \cite{Elkhodr2013} the types of attack are separated into five levels. These
attacks refer to information security, the practice of restricting access to
data to certain groups, and are applicable mostly to privacy issues in the IoT.

\subsubsection{First-Hand Attack}
In a first hand attack, a user inadvertently divulges information to another
party. Either through misconfigured privacy settings, or through the breach of
a vulnerable security protocol, an attacker can gain valuable information.
Although misconfiguration is partially the fault of the user, a security breach
resulting from a difficult to use system, should be seen as the fault of the
system designers. 

\subsubsection{Gossip Attack}
In gossip attack an attacker gains sensitive information by compromising a node
that does not directly interact with the victim. This node may be several hops
from the target, and well beyond the victim's control, yet other nodes have
relayed data regarding the target to it. To mitigate this, emphasis must be
placed on deciding which peers to trust, and what information should be shared
with them.

\subsubsection{Observation Attack}
An observation attack uses sensors placed (or compromised) by an
attacker with the intent of gaining information about their victims. An
attacker might also attempt to capture network traffic with the aim of
obtaining information about the victim. Unlike the other attacks, an
observation attack may make use of strategically placed sensors owned by the
attacker. An example is bank card skimming machines. 

\subsubsection{Inference Attack}
Inference attacks exploit the huge body of data that will be collected by the
IoT. Data can be linked in novel ways, producing sensitive information that was
not revealed by a single data source alone. Understanding privacy in anonymised
datasets is an active research area. In 2007 Netflix launched a competition to
improve their film recommendations. Two researchers from the University of
Texas soon announced they had identified individual users by correlating the
data with the Internet Movie Database (IMDB) \cite{Narayanan2008}.

\subsubsection{Automated Invasion Attack}
A sophisticated attacker can mechanise the process of performing attacks,
making them possible on an extremely large scale. By exploiting the
pervasiveness of sensors in the IoT, an attacker may be able to infer
unexpected, and sensitive, things. Software written to perform these attacks
may also be sold on to less competent individuals. 

\subsection{Potential Attackers}
To defend against attacks, the types of attackers must be identified. McAfee
list these classes of attacker \cite{McAfee2011}: white hat hackers, black hat
hackers, script kiddies, hacktivists, cyber terrorists, state sponsored
hackers, and spy hackers. 

There is much variety in the motives and abilities of attackers. At
the lowest end of the ability scale are script kiddies, who carry out attacks
using scripts\footnote{e.g. Low Orbit Ion Cannon (LOIC), used to perform DoS
attacks.} created by more experienced hackers. For maximum impact, experienced
hackers often instruct script kiddies to run scripts posted on message boards.
This technique is used by the hacker group `Anonymous'. Due to the low barrier
of entry, script kiddies threaten home networks -- it is relatively easy for a
trusted friend or family member to carry out this kind of attack. 

Organised crime has become increasingly involved in cyber crime. As more
sensitive activities are carried out online, the Internet becomes more
appealing to groups of criminals. Organised criminals are typically able to
perform more sophisticated attacks than individuals, and usually have a
financial motive. 

State sponsored hackers are teams of highly skilled, government funded
professionals. Their attacks tend to be the most sophisticated, often using
zero-day vulnerabilities. Necessarily they are shrouded in secrecy so it is
difficult to gauge the extent of these activities. Examples of suspected state
sponsored attacks are the Advanced Persistent Threats (APT) facing many
governments and companies; and the Stuxnet worm that targeted Iranian Nuclear
Power Facilities, stifling the country's nuclear program.  

To ensure their systems and products are secure, companies often employ
whitehat hackers known as penetration testers. These security professionals
attempt to break into the systems to show where weaknesses lie. Thorough
penetration testing results in more secure products for end users.

\section{Prevention and Mitigation} 
There is a large number of potential attacks that can cause severe damage.
Mechanisms and policies are required to reduce the harm an attack can cause. 

\subsection{Legal Frameworks}
Legal action should not be overlooked as an effective measure against cyber
crime. Perfect security does not exist \cite{ThereMustBeA} -- products of any
reasonable complexity are almost certain to contain flaws. Because of this,
laws are needed to act as a safety net by deterring criminals from committing
computer crime. An overview of relevant law can be found in \cite{Weber2010}.
Regulations to hold vendors accountable for defects in their products may help
persuade them to ship devices in a secure state, and encourage thorough
testing. 

\subsection{Hop-by-hop Security}
Hop-by-hop security exists between two directly connected nodes. All of the
protocols mentioned in Section \ref{layer_1_2} offer per hop encryption at the
link layer. 

\subsubsection{WiFi Security}
WiFi security has a troubled past. The first WiFi security protocol, Wired
Equivalent Protocol (WEP), was completely insecure. As WEP used a stream cipher
(RC4), it was vital that keys were never reused. WEP used 24-bit initialisation
vectors (IV) to add uniqueness to the traffic keys. The Birthday Problem meant
that once ~5000 IVs\footnote{Calculated by $\sqrt[]{\frac{pi}{2} 2^{24}} $}
had been collected, the probability of a collision exceeded 50\%. Once a
collision was found the Fluhrer, Mantin and Shamir attack could be used
\cite{Fluhrer2001}. Using {\tt aircrack-ng} any WEP key could be retrieved in
seconds. Once a WEP network was cracked, all traffic to and from the
compromised access point could be read. Fortunately, WEP is rarely used
anymore.

WEP was replaced by WiFi Protected Access (WPA). The original WPA was designed
as a stopgap measure requiring only a firmware upgrade. The successor WPA2 is a
long term solution that requires new hardware, and uses the Advanced Encryption
Standard (AES). WPA has several modes, Pre-shared Key (PSK) is most common
among home users. The only known WPA-PSK vulnerabilities are dictionary
attacks, and rainbow tables; preventable with strong passwords, and random
SSIDs. 

WiFi Protected Setup (WPS), designed to simplify the setup of WiFi networks,
also contained a serious vulnerability \cite{Viehbock2011}. The flaw was in the
PINs authentication: an 8-digit PIN was used, but as it was processed in two
rounds and the last digit is a checksum, the keyspace was only 11,000. {\tt
reaver-wps} can be used to retrieve any WPS PIN in under 24 hours. Some modern
routers have extra precautions, such as disabling WPS after multiple failures. 

\subsubsection{Bluetooth Security}
The Bluetooth specification \cite{BTSpec} defines a stream cipher called E0.
It is optimised for  hardware implementation, using multiple Linear Feedback
Shift Registers (LFSRs) and a simple state machine to generate a pseudorandom
keystream. 

In Kennedy et al. \cite{Kennedy2008}, a dizzying number of potential attacks on
Bluetooth are presented. These include: 
\begin{itemize}[$\bullet$]
\item {\bf BlueJacking:} unexpected messages are sent to the victim hoping they
will reply with login details. 
\item {\bf BlueSnarf:} exploits the Object Exchange Push service to gain
access to a mobile phone's address book. 
\item {\bf BlueBump:} exploits the fact that link keys may be used after a session
has terminated. 
\item {\bf BlueSmack:} allows an attacker to perform a simple DoS attack by
exploiting the L2CAP layer.
\item {\bf BlueDump:} can be used to cause a device to dump its link key if the
 Address of the device is known. 
\item {\bf BlueChop:} by confusing the master node of a piconet, a DoS attack can be
performed. 
\end{itemize}

\subsubsection{IEEE 802.15.4 Security}
IEEE 802.15.4 includes an extensive security specification, offering several
modes of operation: no security, encryption only, authentication only, and
encryption and authentication. AES is used for encryption, with Message
Authentication Codes (MAC) used for Authentication. The protocols are not
perfect though; in 2004 Sastry et al. \cite{Sastry2004} outlined some of the
major problems that existed.  


\subsection{End-to-end Security}
A limitation of hop-by-hop encryption is that all nodes on the path between
sender and receiver can read the message, as it is decrypted before being
forwarded. If a path contains untrusted nodes, end-to-end encryption can be
used to prevent data being read or changed by a middle person. 

\subsubsection{DTLS -- Datagram Transport Layer Security}
Datagram TLS (DTLS) is a datagram security protocol based on Transport Layer
Security (TLS), the protocol that is used to secure HTTP sessions. Because the
IoT is likely to use UDP rather than TCP, DTLS must be used in place of TLS.
DTLS is very similar to TLS, providing mechanisms for key negotiation,
encrypted communication, and MAC generation.  

Serious flaws in TLS implementations have been in the news recently. In
February 2014 Apple published a security update to fix the 'goto fail' in their
implementation of TLS. In this bug a repeated statement resulted in an
incorrect verification of TLS headers. In April 2014 the OpenSSL HeartBleed bug
was disclosed. Incorrect bounds checking in the TLS Heartbeat Extension enabled
a buffer overrun attack, allowing users to retrieve large chunks of memory.
CloudFlare challenged attackers to exploit an experimental server running the
vulnerable software -- within days, researchers had retrieved private keys from
the machine \cite{CloudFlare2014}.

\subsubsection{IPSec}
IPSec adds security extensions to IP, offering the ability to authenticate and
encrypt IP packets. It was introduced with IPv6, and initially was mandatory.
When security was not required, it could be effectively disabled by using the
NULL method. In RFC6463 the requirement was reduced to a recommendation. 

IPSec has several modes of operation: Authentication Header (AH), Encapsulating
Security Payload (ESP), and Security Associations (SA). In AH mode,
authentication is added to packets to ensure authenticity of the IP traffic. A
counter prevents replay attacks. ESP, encrypts the payload of the packet,
providing confidentiality. And SA is used for key distribution. It has been
demonstrated that IPSec can be implemented to run on constrained IoT devices
\cite{Rubertis2013}.  

\subsubsection{Diet HIP}
The Host Identity Protocol (HIP) decouples identification of a host from
location. HIP Base Exchange (BEX) can bootstrap authenticated communications.
HIP Diet Exchange (DEX) is a cut back version of BEX for constrained devices
that replaces the heavyweight cryptographic primitives used in BEX. Lightweight
implementations of DEX have be produced that are suitable for the IoT
\cite{Meca2013}. DEX can be used for key negotiation, producing a session key
that can be used with IPSec or DTLS. 

\subsection{Jamming}
Brown et al. \cite{Brown2013} present a novel mechanism for improving the
functionality and security of primitive home automation hardware. A centralised
controller is used to control the appliances, attached are bridges for each
home automation protocol deployed in the home. The controller acts as a proxy
for all of these devices, allowing the user to control the devices over the
Internet. 

The controller enhances security by listening for unauthorised command signals
which could be interpreted by devices in the home, and emitting jamming signals
to prevent them from having an effect. This mechanism can be used to defend
against accidental attack by a neighbour, and against simplistic malicious
attacks. 

\subsection{Service Level Security}
Security issues also exist with the protocols that are used to reduce the
administration burden of the network. 

\subsubsection{Service Discovery}
Service Discovery may allow a malicious actor to advertise services on a host
that they control, tricking devices into accessing it from here malware may be
injected into the device. For mDNS this is known as an mDNS poisoning attack --
IPSec or DNSSEC allow devices to only accept advertisements from trusted
parties \cite{Cheshire2013}. 

The other major concern with service discovery protocols is that when attached
to public networks, the presence of the device on the network is advertised to
attackers. An attacker may also be able to identify the type of device and if
known vulnerabilities exist. Both the National Security Agency (NSA) and Apple
recommend turning off mDNS when connected to a public network
\cite{NSAMacHardening} \cite{MacConfig}. This solution may not be usable on
constrained devices.

\subsubsection{Routing}
Security considerations for routing over LLNs are outlined in a current
Internet draft \cite{Tsao2014}. The threats mentioned result mainly from
hardware constraints. They include: node impersonation, routing information
exposure, routing information modification, availability reduction attacks and
node resource exhaustion. The draft details countermeasures, such as adding
encryption to the protocol and negotiating with peers over multiple hops.

\subsubsection{Host Autoconfiguration}
SLAAC can be exploited by Router Advertisement spoofing. If `things' can be
convinced to connect to an unauthorised DNS server, then by forging DNS
responses pointing to a machine owned by the attacker, rather than legitimate
addresses, the attacker could attempt exfiltrate data or control the `thing'.
Snooping techniques such as DHCP Guard and {\tt ramond} can be used to prevent
false router information from having an effect on the network hosts.

\subsection{Architectural Decisions}
Many architectural design decisions for the IoT in the home exist. Although
every network is different, best practices are universal. 

\subsubsection{End-to-end Addressability}
The huge address space of IPv6 allows assignment of global IP addresses to
endpoints, removing the need for Network Address Translation (NAT). Allowing
this end-to-end addressability has benefits. Primarily, network complexity is
reduced by the removal of NAT and port mapping. External hosts are also now
able to initiate communications with home devices.

NAT proponents claim it improves security by restricting external
addressability. This is security through obscurity, NAT offers no increase in
security over a firewall. Ideally `things' deployed in home networks should
have global IP addresses to allow them to be controlled remotely -- there
should be strict access control mechanisms, but NAT is not the best way to
achieve this. 

\subsubsection{Application Layer Proxies}
Many currently available `things' do not implement IP themselves. Instead they
use a smartphone as an application layer proxy. For devices that do not require
constant connectivity, this can have security benefits: no security is required
on the thing beyond hop-by-hop encryption to the base station.  Designers no
longer have to worry about security when designing constrained devices, and
users can manage the security policy from one place. There are of course
disadvantages, this arrangement is not suitable for devices that would benefit
from an always-on connection. 

\subsubsection{Internal Subnetworks}
It is strongly recommended that future home networks are divided into multiple
subnets, for example separate networks for smart grid, lighting control and
home entertainment. This is an operational requirement as it prevents high
bandwidth devices overwhelming low bandwidth devices. It also has security
benefits -- filtering can be done at the subnet borders. High-end home routers
already offer this functionality with 'guest' networks isolated from the main
network.

\subsubsection{Increased Host Security}
With the popularity of network edge firewalls and NAT, the security on end-user
devices was not considered a priority. However, given that firewalls are rarely
impenetrable, and the risk of internal attack, endpoints should be designed to
thrive in a hostile environment. `Things' must be careful when deciding which
packets to process.


\section{Future Work}
Despite the large body of work that exists on the security considerations for
the IoT in domestic networks, there are still many unanswered questions. 

\subsection{Secure by Default}
One challenge is ensuring device vendors pick the correct security protocols
for their devices, and adhere to the specifications. It would also be helpful
to develop methods of encouraging product manufacturers to ship their products
with secure, randomly generated, usernames and passwords in order to reduce the
number of attacks that are made on devices that have not been configured away
from the defaults.

\subsection{User Education}
Research must be done on how to teach users about security in their home. The
negative implications of uneducated users is two fold: firstly, they are at
risk of falling victim to an attack; secondly, by running an insecure network,
they can help criminals attack others -- vulnerable `things' could become part
of a `botnet of things'. G. Korteum et al. have presented their findings from
running an Open University Module on the IoT, but their focus is not on
security \cite{Kortuem2013}. As well as user education, usability of device
configuration must be improved. 

\subsection{Outsourcing Security}
Many home users would benefit from the relocation of the security provisions of
their network from inside the home to a third party, such as their ISP
\cite{Kritzinger2013}. This could be achieved using programmable switches and
virtualised network devices, and would require users develop strong trust
relationships with their security providers. New privacy issues would need to
be addressed. Increased bandwidth consumption may also be an issue. Technically
inclined users are likely to be strongly against this, so the service should
be strictly optional.

\subsection{The Cloud of Things}
Cloud computing has become very popular lately -- many users store all of their
data outside their personal machines, and many software packages are now
available `as a service'. As the cloud merges with the IoT, even more sensitive
data will find itself in the cloud. Privacy and accountability questions must
be answered for consumers to be safe.

\subsection{Novel Network Paradigms}
There are a number of novel network paradigms that have been proposed as a
replacement of TCP/IP. One example, Information Centric Networking (ICN), aims
to replace IP with a naming system that is based on the content of the data
being requested, rather than the logical location of the data. Research into
new paradigms would help to evaluate their efficacy and determine whether we
need to rethink the Internet to accommodate the IoT. 


\section{Conclusion}
It is clear that security is an important goal for the design of the IoT. As
technology consumes more and more of people's lives, it is essential that the
correct trade-offs are made from a security standpoint. 

A large number of standards have emerged, each attempting to solve many of the
problems with connecting everyday objects to the Internet. Presently it is not
obvious which protocols will succeed, and which will fade into obscurity. The
most benefits appear to lie within an IPv6 based IoT, as this instantly
provides a robust infrastructure and a number of services, along with strong
future proofing.  


% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)

\bibliography{bare_jrnl}{}
\bibliographystyle{ieeetr}


\end{document}
